(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{60:function(t,e,a){"use strict";a.d(e,"a",function(){return s});a(6);var s=function(t){var e=new FileReader;return new Promise(function(a,s){try{e.readAsDataURL(t),e.onloadend=function(){a(e.result)}}catch(t){throw new Error("Ошибка при чтении файла")}})}},71:function(t,e,a){},72:function(t,e,a){},73:function(t,e,a){},74:function(t,e,a){},86:function(t,e,a){"use strict";var s=a(71);a.n(s).a},87:function(t,e,a){"use strict";var s=a(72);a.n(s).a},88:function(t,e,a){"use strict";var s=a(73);a.n(s).a},89:function(t,e,a){"use strict";var s=a(74);a.n(s).a},93:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"revs container"},[a("div",{staticClass:"block-title"},[a("div",{ref:"blockToScroll",staticClass:"title"},[a("h1",[t._v('Блок "Отзывы"')])])]),a("div",{staticClass:"rev-add-wrapper"},[t.addModeOn?a("addRev",{on:{showBlockAddRev:t.showBlockAddRev}}):t._e(),t.getEditModeState?a("editRev",{attrs:{revToEdit:t.revToEdit}}):t._e()],1),a("ul",{staticClass:"rev__list"},[t.addModeOn?t._e():a("li",{staticClass:"rev-add-btn rev__item rev__item--add"},[a("label",{staticClass:"rev__add-label"},[a("div",{staticClass:"rev__add-visible"},[t._v("+")]),a("input",{staticClass:"rev__add-input",attrs:{type:"button",disabled:t.getEditModeState},on:{click:t.showBlockAddRev}}),a("span",{staticClass:"rev__add-text"},[t._v("Добавить отзыв")])])]),t._l(t.reviews,function(e){return a("li",{key:e.id,staticClass:"rev__item"},[a("revsList",{attrs:{rev:e,addModeOn:t.addModeOn},on:{getCurrentRev:t.getCurrentRev,scrollToEdit:t.scrollToEdit}})],1)})],2)])};s._withStripped=!0;var r=a(40),n=a.n(r),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"addBlockComp",staticClass:"rev-add"},[a("form",{staticClass:"rev-add__form",on:{submit:function(e){return e.preventDefault(),t.createNewRev(e)}}},[a("div",{staticClass:"rev-add__title"},[t._v("Новый отзыв")]),a("div",{staticClass:"rev-add__container"},[a("div",{staticClass:"rev-add__left"},[a("label",{staticClass:"rev-add__label"},[a("input",{staticClass:"rev-add__input",attrs:{type:"file"},on:{change:t.handleFileChange}}),a("div",{staticClass:"rev-add__img",class:{disabled:t.renderedPhoto.length},style:{backgroundImage:"url("+t.renderedPhoto+")"}},[a("div",{staticClass:"rev-add__icon"})]),a("span",{staticClass:"input rev-add__upload"},[t._v("Добавить фото")])])]),a("div",{staticClass:"rev-add__right"},[a("div",{staticClass:"rev-add__row"},[a("label",{staticClass:"rev-add__block"},[a("span",{staticClass:"rev__input-title"},[t._v("Имя автора")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.newRevData.name,expression:"newRevData.name"}],staticClass:"rev__input",attrs:{type:"text",required:""},domProps:{value:t.newRevData.name},on:{input:function(e){e.target.composing||t.$set(t.newRevData,"name",e.target.value)}}})]),a("label",{staticClass:"rev-add__block"},[a("span",{staticClass:"rev__input-title"},[t._v("Титул автора")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.newRevData.position,expression:"newRevData.position"}],staticClass:"rev__input",attrs:{type:"text",required:""},domProps:{value:t.newRevData.position},on:{input:function(e){e.target.composing||t.$set(t.newRevData,"position",e.target.value)}}})])]),a("label",{staticClass:"rev-add__block"},[a("span",{staticClass:"rev__input-title"},[t._v("Отзыв")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newRevData.text,expression:"newRevData.text"}],staticClass:"rev__textarea rev__input",attrs:{type:"text",row:"3",required:""},domProps:{value:t.newRevData.text},on:{input:function(e){e.target.composing||t.$set(t.newRevData,"text",e.target.value)}}})]),a("div",{staticClass:"save-cancel__btns"},[a("button",{staticClass:"btn-cancel btn",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.$emit("showBlockAddRev")}}},[t._v("Отмена")]),a("button",{staticClass:"btn btn-save",attrs:{type:"submit"}},[t._v("Сохранить")])])])])])])};i._withStripped=!0;var o=a(0),c=a.n(o),d=a(1),l=a.n(d),v=a(60),u=a(41),_={components:{},data:function(){return{newRevData:{name:"",position:"",text:"",photo:{}},renderedPhoto:""}},methods:n()({},Object(u.a)("reviews",["addReview"]),{scrollTo:function(){this.$refs.addBlockComp.scrollIntoView()},handleFileChange:function(t){var e=this;this.newRevData.photo=t.target.files[0];var a=this.newRevData.photo;Object(v.a)(a).then(function(t){e.renderedPhoto=t})},validForm:function(){for(var t in this.newRevData)if(!this.newRevData[t])return!1;return!!this.newRevData.photo.name},createNewRev:function(){var t=this;return l()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.validForm())try{t.addReview(t.newRevData),t.newRevData.name="",t.newRevData.position="",t.newRevData.text="",t.newRevData.photo=""}catch(t){console.log(t)}else alert("Все поля формы должны быть заполнены");case 1:case"end":return e.stop()}},e)}))()}})},p=(a(86),a(7)),h=Object(p.a)(_,i,[],!1,null,null,null);h.options.__file="src/admin/components/addRev.vue";var f=h.exports,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"revs-wrap"},[a("div",{staticClass:"rev__row"},[a("div",{staticClass:"rev__img"},[a("img",{staticClass:"rev__icon",attrs:{src:t.baseURL+t.rev.photo}})]),a("div",{staticClass:"rev__info"},[a("h3",[t._v(t._s(t.rev.author))]),a("p",[t._v(t._s(t.rev.occ))])])]),a("div",{staticClass:"rev__content"},[a("p",[t._v(t._s(t.rev.text))])]),a("div",{staticClass:"rev__btns"},[a("label",{staticClass:"btn-label"},[a("span",{staticClass:"btn-text"},[t._v("Править")]),a("button",{staticClass:"edit edit--blue",attrs:{type:"button",disabled:t.addModeOn||t.getEditModeState},on:{click:function(e){return e.preventDefault(),t.toggleEdit(e)}}})]),a("label",{staticClass:"btn-label"},[a("span",{staticClass:"btn-text"},[t._v("Удалить")]),a("button",{staticClass:"cross",attrs:{type:"button"},on:{click:t.removeCurrentRev}})])])])};m._withStripped=!0;var b=a(20),w={components:{},props:{rev:Object,addModeOn:Boolean},data:function(){return{baseURL:"https://webdev-api.loftschool.com/"}},computed:n()({},Object(b.c)("works",["getEditModeState"])),methods:n()({},Object(b.b)("reviews",["removeRev","toggleEditMode"]),{removeCurrentRev:function(){var t=this;return l()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.removeRev(t.rev);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}},e,null,[[0,5]])}))()},toggleEdit:function(){this.toggleEditMode(this.getEditModeState),this.$emit("getCurrentRev",this.rev),this.$emit("scrollToEdit")}})},C=(a(87),Object(p.a)(w,m,[],!1,null,null,null));C.options.__file="src/admin/components/revsList.vue";var R=C.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"editBlockComp",staticClass:"rev-edit"},[a("form",{staticClass:"rev-add__form",on:{submit:function(e){return e.preventDefault(),t.editCurrentRev(e)}}},[a("div",{staticClass:"rev-add__title"},[t._v("Редактирование отзыва")]),a("div",{staticClass:"rev-add__container"},[a("div",{staticClass:"rev-add__left"},[a("label",{staticClass:"rev-add__label"},[a("input",{staticClass:"rev-add__input",attrs:{type:"file"},on:{change:t.handleFileChange}}),a("div",{staticClass:"rev-add__img",class:{disabled:t.renderedPhoto.length},style:{backgroundImage:"url("+t.renderedPhoto+")"}},[a("div",{staticClass:"rev-add__icon"})]),a("span",{staticClass:"input rev-add__upload"},[t._v("Добавить фото")])])]),a("div",{staticClass:"rev-add__right"},[a("div",{staticClass:"rev-add__row"},[a("label",{staticClass:"rev-add__block"},[a("span",{staticClass:"rev__input-title"},[t._v("Имя автора")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentRev.author,expression:"currentRev.author"}],staticClass:"rev__input",attrs:{type:"text",required:""},domProps:{value:t.currentRev.author},on:{input:function(e){e.target.composing||t.$set(t.currentRev,"author",e.target.value)}}})]),a("label",{staticClass:"rev-add__block"},[a("span",{staticClass:"rev__input-title"},[t._v("Титул автора")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentRev.occ,expression:"currentRev.occ"}],staticClass:"rev__input",attrs:{type:"text",required:""},domProps:{value:t.currentRev.occ},on:{input:function(e){e.target.composing||t.$set(t.currentRev,"occ",e.target.value)}}})])]),a("label",{staticClass:"rev-add__block"},[a("span",{staticClass:"rev__input-title"},[t._v("Отзыв")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currentRev.text,expression:"currentRev.text"}],staticClass:"rev__textarea rev__input",attrs:{type:"text",row:"3",required:""},domProps:{value:t.currentRev.text},on:{input:function(e){e.target.composing||t.$set(t.currentRev,"text",e.target.value)}}})]),a("div",{staticClass:"save-cancel__btns"},[a("button",{staticClass:"btn-cancel btn",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.toggleEdit(e)}}},[t._v("Отмена")]),a("button",{staticClass:"btn btn-save",attrs:{type:"submit"}},[t._v("Сохранить")])])])])])])};g._withStripped=!0;var x={components:{},data:function(){return{currentRev:{},renderedPhoto:""}},props:{revToEdit:Object},created:function(){this.currentRev=this.revToEdit},computed:n()({},Object(u.b)("reviews",["getEditModeState"])),methods:n()({},Object(u.a)("reviews",["editReview","toggleEditMode"]),{scrollTo:function(){this.$refs.editBlockComp.scrollIntoView()},handleFileChange:function(t){var e=this;this.currentRev.photo=t.target.files[0];var a=this.currentRev.photo;Object(v.a)(a).then(function(t){e.renderedPhoto=t})},toggleEdit:function(){this.toggleEditMode(this.getEditModeState)},validForm:function(){for(var t in this.currentRev)if(!this.currentRev[t])return!1;return!0},editCurrentRev:function(){var t=this;return l()(c.a.mark(function e(){var a,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.validForm()){e.next=18;break}return(a=new FormData).set("author",t.currentRev.author),a.set("occ",t.currentRev.occ),a.set("text",t.currentRev.text),t.currentRev.photo.name&&a.set("photo",t.currentRev.photo),s={id:t.currentRev.id,data:a},e.prev=7,e.next=10,t.editReview(s);case 10:t.toggleEditMode(t.getEditModeState),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),console.log(e.t0);case 16:e.next=19;break;case 18:alert("Все поля формы должны быть заполнены");case 19:case"end":return e.stop()}},e,null,[[7,13]])}))()}})},k=(a(88),Object(p.a)(x,g,[],!1,null,null,null));k.options.__file="src/admin/components/editRev.vue";var E={components:{revsList:R,addRev:f,editRev:k.exports},data:function(){return{addModeOn:!1,revToEdit:{}}},computed:n()({},Object(u.c)("reviews",{reviews:function(t){return t.reviews}}),Object(u.b)("reviews",["getEditModeState"])),created:function(){this.fetchReviews()},methods:n()({},Object(u.a)("reviews",["fetchReviews"]),{showBlockAddRev:function(){this.addModeOn=!this.addModeOn,this.addModeOn&&this.scroll()},scroll:function(){this.$refs.blockToScroll.scrollIntoView({block:"start",inline:"nearest"})},scrollToEdit:function(){this.$refs.blockToScroll.scrollIntoView(!0)},getCurrentRev:function(t){this.revToEdit=this.reviews.find(function(e){return e.id===t.id})}})},D=(a(89),Object(p.a)(E,s,[],!1,null,null,null));D.options.__file="src/admin/components/reviews.vue";e.default=D.exports}}]);